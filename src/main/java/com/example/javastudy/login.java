package com.example.javastudy;

import jakarta.servlet.ServletException;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.*;
import java.io.*;
import com.alibaba.fastjson.JSONObject;
import com.alibaba.fastjson.JSON;

@WebServlet(name = "login", value = "/login")
public class login extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // 实例化读取POST请求数据的对象
        BufferedReader reader = new BufferedReader(request.getReader());
        // 读取POST请求数据
        String json = reader.readLine();
        // 输出到控制台
        System.out.println(json);
        // 用fastjson进行反序列化
        JSONObject jo = JSON.parseObject(json);
        // 获取username和password对应的值
        String username = jo.getString("username");
        String password = jo.getString("password");
        // 输出到控制台
        System.out.println("用户名: "+username+","+"密码: "+password);
        // 省略判断账号密码是否正确和设置session等步骤
        // 假设账号密码正确，跳转到home页
        response.sendRedirect("home");
    }
}